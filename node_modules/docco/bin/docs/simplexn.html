<!DOCTYPE html>  <html> <head>   <title>simplexn.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               simplexn.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p><strong>simplexn.coffee</strong> is
a prototype geometric kernel for plasm.js, 
the <em>JavaScript Programming Language for Solid Modeling</em></p>

<p>Copyright (c) 2011-2012 Universit√† Roma Tre, CVD-lab <a href="&#109;&#97;&#105;l&#116;&#x6F;:&#x63;&#x76;&#x64;l&#x61;&#x62;&#x40;&#x65;&#x6D;&#97;&#x69;&#108;&#46;&#99;&#111;m">&#x63;&#x76;&#x64;l&#x61;&#x62;&#x40;&#x65;&#x6D;&#97;&#x69;&#108;&#46;&#99;&#111;m</a></p>

<p>The source for <a href="https://github.com/cvd-lab/">Plasm.js</a> is available on GitHub,
and released under the MIT license.
<HR></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>To make the qualified symbols visible to the root object (typically Window)</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root = </span><span class="nx">exports</span> <span class="o">?</span> <span class="k">this</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <h1>#</h1>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Imported symbols from Math object</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="p">{</span><span class="nx">PI</span><span class="p">,</span> <span class="nx">E</span><span class="p">,</span> <span class="nx">log</span><span class="p">,</span> <span class="nx">sin</span><span class="p">,</span> <span class="nx">cos</span><span class="p">,</span> <span class="nx">tan</span><span class="p">,</span> <span class="nx">asin</span><span class="p">,</span> <span class="nx">acos</span><span class="p">,</span> <span class="nx">atan</span><span class="p">,</span> <span class="nx">atan2</span><span class="p">,</span> <span class="nx">ceil</span><span class="p">,</span> <span class="nx">floor</span><span class="p">,</span> <span class="nx">sqrt</span><span class="p">,</span> <span class="nx">exp</span><span class="p">,</span> <span class="nx">abs</span><span class="p">,</span> <span class="nx">round</span><span class="p">}</span> <span class="o">=</span> <span class="nb">Math</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p><HR></p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <h3>Operators for <a href="http://en.wikipedia.org/wiki/FL_(programming_language&#41;">FL-style</a> <a href="http://en.wikipedia.org/wiki/Function-level_programming">programming</a></h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p><strong>APPLY</strong> returns the result of the application expression <code>f(x)</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.APPLY = APPLY = </span><span class="nf">(args) -&gt;</span>  <span class="p">[</span><span class="nx">f</span><span class="p">,</span> <span class="nx">x</span><span class="p">]</span> <span class="o">=</span> <span class="nx">args</span><span class="p">;</span> <span class="nx">f</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="kc">null</span><span class="p">,[</span><span class="nx">x</span><span class="p">])</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p><strong>COMP</strong> composition. Returns the composition of the <code>funs</code> array in the argument</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.COMP = COMP = </span><span class="nf">(funs) -&gt;</span> 
	<span class="nv">comp2 = </span><span class="nf">(f,g) -&gt;</span> <span class="nf">(x) -&gt;</span> <span class="nx">f</span> <span class="p">(</span><span class="nx">g</span> <span class="nx">x</span><span class="p">)</span>
	<span class="nx">funs</span><span class="p">.</span><span class="nx">reduce</span> <span class="nx">comp2</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p><strong>CONS</strong> construction. Applies a function array <code>[f_1, ..., f_n]</code> to the <code>x</code> argument,
producing the array of application values: <code>[f_1(x), ..., f_n(x)]</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.CONS = CONS = </span><span class="nf">(flist) -&gt;</span> <span class="nf">(x) -&gt;</span> <span class="nx">flist</span><span class="p">.</span><span class="nx">map</span> <span class="nf">(f) -&gt;</span> <span class="nx">f</span> <span class="nx">x</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p><strong>CAT</strong> catenates <code>args</code>, an array of arrays, by eliminating a level of nesting</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.CAT = CAT = </span><span class="nf">(args) -&gt;</span> <span class="p">[].</span><span class="nx">concat</span> <span class="nx">args</span><span class="p">...</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p><strong>ID</strong> returns the <code>arg</code> argument unchanged</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.ID = ID = </span><span class="nf">(arg) -&gt;</span> <span class="nx">arg</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p><strong>K</strong> constant functional that always returns the first argument (<code>a</code>), for any value of the second one (<code>b</code>)</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.K = K = </span><span class="nf">(a) -&gt;</span> <span class="nf">(b) -&gt;</span> <span class="nx">a</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p><strong>AA</strong> applies <code>fun</code> to each element of <code>array</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.AA = AA = </span><span class="nf">(fun) -&gt;</span> <span class="nf">(array) -&gt;</span> <span class="nx">array</span><span class="p">.</span><span class="nx">map</span> <span class="nf">(e) -&gt;</span> <span class="nx">fun</span> <span class="nx">e</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p><strong>DISTR</strong> distribute right. Returns the <code>pair</code> sequence with the elements of <code>array</code> and <code>x</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.DISTR = DISTR = </span><span class="nf">(pair) -&gt;</span> <span class="p">[</span><span class="nx">array</span><span class="p">,</span><span class="nx">x</span><span class="p">]</span> <span class="o">=</span> <span class="nx">pair</span><span class="p">;</span> <span class="p">[</span><span class="nx">el</span><span class="p">,</span><span class="nx">x</span><span class="p">]</span> <span class="k">for</span> <span class="nx">el</span> <span class="k">in</span> <span class="nx">array</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p><strong>DISTL</strong> distribute left. Returns the <code>pair</code> sequence with <code>x</code> and the elements of <code>array</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.DISTL = DISTL = </span><span class="nf">(pair) -&gt;</span> <span class="p">[</span><span class="nx">x</span><span class="p">,</span><span class="nx">array</span><span class="p">]</span> <span class="o">=</span> <span class="nx">pair</span><span class="p">;</span> <span class="p">[</span><span class="nx">x</span><span class="p">,</span><span class="nx">el</span><span class="p">]</span> <span class="k">for</span> <span class="nx">el</span> <span class="k">in</span> <span class="nx">array</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p><strong>INSR</strong> insert right combinator, allowing to apply a binary operator <code>op</code> to an <code>array</code> of n arguments</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.INSR = INSR = </span><span class="nf">(op) -&gt;</span> <span class="nf">(array) -&gt;</span> <span class="nx">array</span><span class="p">.</span><span class="nx">reduceRight</span> <span class="nx">op</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p><strong>INSL</strong> insert left combinator, allowing to apply a binary operator <code>op</code> to an <code>array</code> of n arguments</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.INSL = INSL = </span><span class="nf">(op) -&gt;</span> <span class="nf">(array) -&gt;</span> <span class="nx">array</span><span class="p">.</span><span class="nx">reduce</span> <span class="nx">op</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p><strong>TREE</strong>  applies a binary operator <code>op</code> to an <code>array</code> of n arguments</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.TREE = TREE = </span><span class="nf">(op) -&gt;</span> 
	<span class="nv">tree = </span><span class="nf">(fun,array) -&gt;</span>
		<span class="nv">len = </span><span class="nx">array</span><span class="p">.</span><span class="nx">length</span>
		<span class="k">if</span> <span class="nx">len</span> <span class="o">is</span> <span class="mi">1</span> <span class="k">then</span> <span class="k">return</span> <span class="nx">array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="nv">k = </span><span class="nx">floor</span> <span class="p">(</span><span class="nx">len</span><span class="err">/2)</span>
		<span class="nx">fun</span><span class="p">(</span> <span class="nx">CAT</span> <span class="p">[</span><span class="nx">tree</span><span class="p">(</span><span class="nx">fun</span><span class="p">,</span> <span class="nx">array</span><span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">k</span><span class="p">]),</span> <span class="nx">tree</span><span class="p">(</span><span class="nx">fun</span><span class="p">,</span> <span class="nx">array</span><span class="p">[</span><span class="nx">k</span><span class="p">...</span><span class="nx">len</span><span class="p">])]</span> <span class="p">)</span>
	<span class="nf">(array) -&gt;</span> <span class="nx">tree</span><span class="p">(</span><span class="nx">op</span><span class="p">,</span><span class="nx">array</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p><strong>BIGGER</strong> is a binary operator that returns the greater of arguments</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.BIGGER = BIGGER = </span><span class="nf">(a,b) -&gt;</span> <span class="k">if</span> <span class="nx">a</span> <span class="o">&gt;</span> <span class="nx">b</span> <span class="k">then</span> <span class="nx">a</span> <span class="k">else</span> <span class="nx">b</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p><strong>SMALLER</strong> binary operator that returns the smaller argument (in a proper ordering!)</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.SMALLER = SMALLER = </span><span class="nf">(a,b) -&gt;</span> <span class="k">if</span> <span class="nx">a</span> <span class="o">&lt;</span> <span class="nx">b</span> <span class="k">then</span> <span class="nx">a</span> <span class="k">else</span> <span class="nx">b</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p><strong>BIGGEST</strong> binary operator that returns the greatest of <code>args</code> values</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.BIGGEST = BIGGEST = </span><span class="nf">(args) -&gt;</span> <span class="p">(</span><span class="nx">INSR</span> <span class="nx">BIGGER</span><span class="p">)</span> <span class="nx">args</span> </pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p><strong>SMALLEST</strong> returns the smallest element of the <code>args</code> input sequence</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.SMALLEST = SMALLEST = </span><span class="nf">(args) -&gt;</span> <span class="p">(</span><span class="nx">INSR</span> <span class="nx">SMALLER</span><span class="p">)</span> <span class="nx">args</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p><strong>LIST</strong> returns an array containing <code>arg</code>. Alias for<code>CONS([ID])</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.LIST = LIST = </span><span class="nf">(arg) -&gt;</span> <span class="p">(</span><span class="nx">CONS</span> <span class="p">[</span><span class="nx">ID</span><span class="p">])</span> <span class="nx">arg</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p><strong>LEN</strong> returns the length of the array <code>args</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.LEN = LEN = </span><span class="nf">(args) -&gt;</span> <span class="nx">args</span><span class="p">.</span><span class="nx">length</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p><strong>REVERSE</strong> returns the <code>args</code> array in reverse order</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.REVERSE = REVERSE = </span><span class="nf">(args) -&gt;</span> <span class="k">if</span> <span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">then</span> <span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="k">for</span> <span class="nx">i</span> <span class="k">in</span> <span class="p">[</span><span class="nx">args</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">..</span><span class="mi">0</span><span class="p">])</span> <span class="k">else</span> <span class="nx">args</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p><strong>TAIL</strong> returns the non-empty <code>args</code> array but its <em>first</em> element</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.TAIL = TAIL = </span><span class="nf">(args) -&gt;</span> <span class="k">if</span> <span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">then</span> <span class="nx">args</span><span class="p">.</span><span class="nx">splice</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">args</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="nx">args</span></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p><strong>BUTLAST</strong> returns the non-empty <code>args</code> array but its <em>last</em> element</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.BUTLAST = BUTLAST = </span><span class="nf">(args) -&gt;</span> <span class="k">if</span> <span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">then</span> <span class="nx">REVERSE</span> <span class="nx">TAIL</span> <span class="nx">REVERSE</span> <span class="nx">args</span> <span class="k">else</span> <span class="p">[]</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p><strong>AL</strong> append left. appends <code>elem</code> on the left of <code>array</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.AL = AL = </span><span class="nf">(args) -&gt;</span> <span class="p">[</span><span class="nx">array</span><span class="p">,</span> <span class="nx">elem</span><span class="p">]</span> <span class="o">=</span> <span class="nx">args</span><span class="p">;</span> <span class="nx">CAT</span> <span class="p">[</span><span class="nx">array</span><span class="p">,</span> <span class="nx">elem</span><span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p><strong>AR</strong> append right. appends <code>elem</code> on the right of <code>seq</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.AR = AR = </span><span class="nf">(args) -&gt;</span> <span class="p">[</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">array</span><span class="p">]</span> <span class="o">=</span> <span class="nx">args</span><span class="p">;</span>  <span class="nx">CAT</span> <span class="p">[</span><span class="nx">elem</span><span class="p">,</span> <span class="nx">array</span><span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p><strong>REPEAT</strong> repetition operator. Returns an array with <code>n</code> repetitions of <code>arg</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.REPEAT = REPEAT = </span><span class="nf">(n) -&gt;</span> <span class="nf">(args) -&gt;</span> <span class="p">(</span><span class="nx">args</span> <span class="k">for</span> <span class="nx">i</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">n</span><span class="p">])</span></pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p><strong>REPLICA</strong> array repetition operator (with catenation). 
<code>REPLICA(n)(array)</code> is equivalent to <code>COMP([CAT,REPEAT(n)])(array)</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.REPLICA = REPLICA = </span><span class="nf">(n) -&gt;</span> <span class="nf">(args) -&gt;</span> <span class="nx">CAT</span> <span class="p">(</span><span class="nx">args</span> <span class="k">for</span> <span class="nx">i</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">n</span><span class="p">])</span></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p><strong>SUM</strong> arithmetic operation between numbers or number arrays</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.SUM = SUM = </span><span class="nf">(args) -&gt;</span> <span class="k">if</span> <span class="k">typeof</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">is</span> <span class="s1">&#39;number&#39;</span> <span class="k">then</span> <span class="p">(</span><span class="nx">INSL</span> <span class="nf">(x,y) -&gt;</span> <span class="nx">x</span><span class="o">+</span><span class="nx">y</span><span class="p">)</span> <span class="nx">args</span> <span class="k">else</span> <span class="nx">AA</span><span class="p">(</span><span class="nx">INSL</span> <span class="nf">(x,y) -&gt;</span> <span class="nx">x</span><span class="o">+</span><span class="nx">y</span><span class="p">)(</span><span class="nx">TRANS</span> <span class="nx">args</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p><strong>SUB</strong> arithmetic operation between numbers or number arrays</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.SUB = SUB = </span><span class="nf">(args) -&gt;</span> <span class="k">if</span> <span class="k">typeof</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">is</span> <span class="s1">&#39;number&#39;</span> <span class="k">then</span> <span class="p">(</span><span class="nx">INSL</span> <span class="nf">(x,y) -&gt;</span> <span class="nx">x</span><span class="o">-</span><span class="nx">y</span><span class="p">)</span> <span class="nx">args</span> <span class="k">else</span> <span class="nx">AA</span><span class="p">(</span><span class="nx">INSL</span> <span class="nf">(x,y) -&gt;</span> <span class="nx">x</span><span class="o">-</span><span class="nx">y</span><span class="p">)(</span><span class="nx">TRANS</span> <span class="nx">args</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <p><strong>MUL</strong> arithmetic operation between numbers or number arrays</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.MUL = MUL = </span><span class="nf">(args) -&gt;</span> <span class="k">if</span> <span class="k">typeof</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">is</span> <span class="s1">&#39;number&#39;</span> <span class="k">then</span> <span class="p">(</span><span class="nx">INSL</span> <span class="nf">(x,y) -&gt;</span> <span class="nx">x</span><span class="o">*</span><span class="nx">y</span><span class="p">)</span> <span class="nx">args</span> <span class="k">else</span> <span class="nx">AA</span><span class="p">(</span><span class="nx">INSL</span> <span class="nf">(x,y) -&gt;</span> <span class="nx">x</span><span class="o">*</span><span class="nx">y</span><span class="p">)(</span><span class="nx">TRANS</span> <span class="nx">args</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p><strong>DIV</strong> arithmetic operation between numbers or number arrays</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.DIV = DIV = </span><span class="nf">(args) -&gt;</span> <span class="k">if</span> <span class="k">typeof</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">is</span> <span class="s1">&#39;number&#39;</span> <span class="k">then</span> <span class="p">(</span><span class="nx">INSL</span> <span class="nf">(x,y) -&gt;</span> <span class="nx">x</span><span class="err">/y) args else AA(INSL (x,y) -&gt; x/y)(TRANS args)</span></pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p><strong>TRANS</strong> transposes <code>args</code> (an array of arrays of the same length), like <em>matrix</em> transposition</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.TRANS = TRANS = </span><span class="nf">(args) -&gt;</span>
	<span class="nv">n = </span><span class="nx">args</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nv">m = </span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="p">;</span> <span class="nv">args = </span><span class="nx">CAT</span> <span class="nx">args</span>
	<span class="p">((</span><span class="nx">args</span><span class="p">[</span><span class="nx">j</span><span class="o">*</span><span class="nx">m</span><span class="o">+</span><span class="nx">i</span><span class="p">]</span> <span class="k">for</span> <span class="nx">j</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">n</span><span class="p">])</span> <span class="k">for</span> <span class="nx">i</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">m</span><span class="p">])</span></pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p><strong>VECT</strong> type casting <em>binary</em> operations</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.VECT = VECT = </span><span class="nf">(binaryop) -&gt;</span> <span class="nf">(args) -&gt;</span> <span class="nx">AA</span><span class="p">(</span><span class="nx">binaryop</span><span class="p">)</span> <span class="nx">TRANS</span> <span class="nx">args</span></pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <p><strong>MAT</strong> transform a linear array <code>args</code> into an array of arrays with <code>m</code> rows and <code>n</code> columns</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.MAT = MAT = </span><span class="nf">(m,n) -&gt;</span> <span class="nf">(args) -&gt;</span> <span class="p">((</span><span class="nx">args</span><span class="p">[</span><span class="nx">i</span><span class="o">*</span><span class="nx">n</span><span class="o">+</span><span class="nx">j</span><span class="p">]</span> <span class="k">for</span> <span class="nx">j</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">n</span><span class="p">])</span> <span class="k">for</span> <span class="nx">i</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">m</span><span class="p">])</span> <span class="c1"># mat</span></pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p><strong>ISNUM</strong> predicate to test if <code>n</code> is a number</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.ISNUM = ISNUM = </span><span class="nf">(n) -&gt;</span> <span class="p">(</span><span class="o">not</span> <span class="nb">isNaN</span> <span class="nb">parseFloat</span> <span class="nx">n</span><span class="p">)</span> <span class="o">and</span> <span class="nb">isFinite</span> <span class="nx">n</span></pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <p><strong>ISFUN</strong> predicate to test if <code>arg</code> is a function</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.ISFUN = ISFUN = </span><span class="nf">(arg) -&gt;</span> <span class="k">if</span> <span class="k">typeof</span> <span class="nx">arg</span> <span class="o">is</span> <span class="s2">&quot;function&quot;</span> <span class="k">then</span> <span class="kc">true</span> <span class="k">else</span> <span class="kc">false</span></pre></div>             </td>           </tr>                               <tr id="section-41">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-41">&#182;</a>               </div>               <p><strong>PROGRESSIVE_SUM</strong> returns the incremental sum of <code>args</code> starting from 0</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.PROGRESSIVE_SUM = PROGRESSIVE_SUM = </span><span class="nf">(args) -&gt;</span>
	<span class="nx">AL</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="nx">INSR</span> <span class="nf">(x,y) -&gt;</span> <span class="nx">x</span><span class="o">+</span><span class="nx">y</span><span class="p">)</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">..</span><span class="nx">i</span><span class="p">]</span> <span class="k">for</span> <span class="nx">i</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">args</span><span class="p">.</span><span class="nx">length</span><span class="p">]]</span></pre></div>             </td>           </tr>                               <tr id="section-42">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-42">&#182;</a>               </div>               <p><strong>SET</strong> transforms an <code>array</code> with possibly repeated elements to one without repetitions</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.SET = SET = </span><span class="nf">(array) -&gt;</span>
	<span class="nv">dict = </span><span class="p">{};</span> <span class="nx">dict</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">k</span> <span class="k">for</span> <span class="nx">k</span> <span class="k">in</span> <span class="nx">array</span><span class="p">;</span> 
	<span class="p">(</span><span class="nx">val</span> <span class="k">for</span> <span class="nx">key</span><span class="p">,</span><span class="nx">val</span> <span class="k">of</span> <span class="nx">dict</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-43">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-43">&#182;</a>               </div>               <p><strong>CART2</strong> returns the Cartesian product of two sequences</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.CART2 = CART2 = </span><span class="nf">(listOfLists) -&gt;</span> <span class="nx">CAT</span><span class="p">(</span><span class="nx">AA</span><span class="p">(</span><span class="nx">DISTL</span><span class="p">)(</span><span class="nx">DISTR</span><span class="p">(</span><span class="nx">listOfLists</span><span class="p">)))</span>
<span class="nv">F1 = </span><span class="nf">(listOfLists) -&gt;</span> <span class="nx">AA</span><span class="p">(</span><span class="nx">AA</span><span class="p">(</span><span class="nx">LIST</span><span class="p">))(</span><span class="nx">listOfLists</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-44">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-44">&#182;</a>               </div>               <p><strong>CART</strong> = CART = (listOfList) -> TREE( COMP([AA(CAT), CART2]) ) ( F1(listOfList) )</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-45">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-45">&#182;</a>               </div>               <p><HR> </p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-46">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-46">&#182;</a>               </div>               <h3>Some utility functions</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-47">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-47">&#182;</a>               </div>               <p><strong>PRINT</strong> returns arg and prints its value to <code>console.log</code>. It may be used for debugging</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.PRINT = PRINT = </span><span class="nf">(string,params) -&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="nx">string</span><span class="p">,</span> <span class="nx">params</span><span class="p">,</span> <span class="s2">&quot;\n&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-48">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-48">&#182;</a>               </div>               <p><strong>CLONE</strong> makes a deep copy of the <code>obj</code> argument. A CoffeeScript <code>type</code> function from 
<a href="http://coffeescriptcookbook.com/chapters/classes_and_objects/cloning">CoffeeScript Cookbook</a></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.CLONE = CLONE = </span><span class="nf">(obj) -&gt;</span>
	<span class="k">if</span> <span class="o">not</span> <span class="nx">obj</span><span class="o">?</span> <span class="o">or</span> <span class="k">typeof</span> <span class="nx">obj</span> <span class="o">isnt</span> <span class="s1">&#39;object&#39;</span>
		<span class="k">return</span> <span class="nx">obj</span>
	<span class="nv">newInstance = </span><span class="k">new</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">constructor</span><span class="p">()</span>
	<span class="k">for</span> <span class="nx">key</span> <span class="k">of</span> <span class="nx">obj</span>
		<span class="nx">newInstance</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">CLONE</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span>
	<span class="nx">newInstance</span></pre></div>             </td>           </tr>                               <tr id="section-49">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-49">&#182;</a>               </div>               <p>Another <code>type</code> function from 
<a href="http://coffeescriptcookbook.com/chapters/classes_and_objects/type-function">CoffeeScript Cookbook</a></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">type = </span><span class="nf">(obj) -&gt;</span>
	<span class="k">if</span> <span class="nx">obj</span> <span class="o">==</span> <span class="kc">undefined</span> <span class="o">or</span> <span class="nx">obj</span> <span class="o">==</span> <span class="kc">null</span>
		<span class="k">return</span> <span class="nb">String</span> <span class="nx">obj</span>
	<span class="nv">classToType = </span><span class="k">new</span> <span class="nb">Object</span>
	<span class="k">for</span> <span class="nx">name</span> <span class="k">in</span> <span class="s2">&quot;Boolean Number String Function Array Date RegExp&quot;</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
		<span class="nx">classToType</span><span class="p">[</span><span class="s2">&quot;[object &quot;</span> <span class="o">+</span> <span class="nx">name</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">name</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span>
	<span class="nv">myClass = </span><span class="nb">Object</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">toString</span><span class="p">.</span><span class="nx">call</span> <span class="nx">obj</span>
	<span class="k">if</span> <span class="nx">myClass</span> <span class="k">of</span> <span class="nx">classToType</span>
		<span class="k">return</span> <span class="nx">classToType</span><span class="p">[</span><span class="nx">myClass</span><span class="p">]</span>
	<span class="k">return</span> <span class="s2">&quot;object&quot;</span>
	
<span class="nv">typedPrint = </span><span class="nf">(args) -&gt;</span>
	<span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s2">&quot;#{type args}::#{args}&quot;</span><span class="p">;</span>
	<span class="nx">args</span></pre></div>             </td>           </tr>                               <tr id="section-50">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-50">&#182;</a>               </div>               <p><HR> </p>

<h3>Symbolic from/to numeric</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-51">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-51">&#182;</a>               </div>               <p>Scaling factor to be used for numeric to symbolic conversions</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.PRECISION = PRECISION = </span><span class="o">+</span><span class="p">(</span><span class="s2">&quot;1E#{digits}&quot;</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-52">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-52">&#182;</a>               </div>               <p>number of decimal digits of stored data</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">digits = </span><span class="mi">9</span></pre></div>             </td>           </tr>                               <tr id="section-53">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-53">&#182;</a>               </div>               <p>To transform a floating-point <code>number</code> √¨nto a fixed-precision value</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">fixedPrecision = </span><span class="nf">(number) -&gt;</span>
	<span class="nv">int = </span><span class="nx">round</span> <span class="nx">number</span>
	<span class="nv">number = </span><span class="nx">round</span><span class="p">(</span><span class="nx">PRECISION</span> <span class="o">*</span> <span class="nx">number</span><span class="p">)</span> <span class="o">/</span> <span class="nx">PRECISION</span>
	<span class="k">if</span> <span class="nx">abs</span><span class="p">(</span><span class="nx">number</span><span class="o">-</span><span class="nx">int</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="o">/</span><span class="nx">PRECISION</span> <span class="k">then</span> <span class="nx">int</span> <span class="k">else</span> <span class="nx">number</span></pre></div>             </td>           </tr>                               <tr id="section-54">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-54">&#182;</a>               </div>               <p>The coordinate representation of a <code>point</code> is transformed to fixed-precision</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">fcode = </span><span class="nf">(point) -&gt;</span> <span class="p">(</span><span class="nx">AA</span> <span class="nx">fixedPrecision</span><span class="p">)</span> <span class="nx">point</span></pre></div>             </td>           </tr>                               <tr id="section-55">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-55">&#182;</a>               </div>               <p><strong>CODE</strong> is a function transforming a <code>point</code> representation into a symbolic format</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.CODE = CODE = </span><span class="nf">(point) -&gt;</span> <span class="s2">&quot;[#{fcode point}]&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-56">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-56">&#182;</a>               </div>               <p>Numeric decoding of the <code>string</code> representation of a number</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">decode = </span><span class="nf">(string) -&gt;</span> <span class="o">+</span><span class="nx">string</span>  <span class="c1"># =&gt; a number</span></pre></div>             </td>           </tr>                               <tr id="section-57">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-57">&#182;</a>               </div>               <p>Numeric decoding of <code>pointCode</code>, the <em>string</em> representation of a <em>d-dimensional</em> point</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">uncode = </span><span class="nf">(pointCode) -&gt;</span> <span class="p">(</span><span class="nx">AA</span> <span class="nx">decode</span><span class="p">)</span> <span class="nx">pointCode</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[\[\]]/g</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-58">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-58">&#182;</a>               </div>               <p>Transformation from the <code>string</code> representation of a number list to a standard array of numbers</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">string2numberList = </span><span class="nf">(string) -&gt;</span>
	<span class="k">if</span> <span class="nx">string</span> <span class="o">is</span> <span class="s1">&#39;[]&#39;</span> <span class="k">then</span> <span class="p">[]</span> <span class="k">else</span>
		<span class="nv">regex = </span><span class="sr">/[,|\[|\]]/</span> <span class="c1"># regex =&gt; &quot;[&quot; or &quot;,&quot; or &quot;]&quot;</span>
		<span class="p">(</span><span class="nx">AA</span> <span class="nb">Number</span><span class="p">)</span> <span class="nx">BUTLAST</span> <span class="nx">TAIL</span> <span class="nx">string</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="nx">regex</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-59">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-59">&#182;</a>               </div>               <p><HR> </p>

<h3>PointSet class</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-60">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-60">&#182;</a>               </div>               <p>The class used to represent a <em>set of points</em>, providing numeric to symbolic conversion, 
storage and fast retrieval.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">class</span> <span class="nx">PointSet</span>
	</pre></div>             </td>           </tr>                               <tr id="section-61">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-61">&#182;</a>               </div>               <p>binary composition of maps, i.e. of dictionaries ...</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">mapcomp = </span><span class="nf">(map1,map2) -&gt;</span> <span class="nv">MAP = </span><span class="p">{};</span> <span class="nx">MAP</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">map2</span><span class="p">[</span><span class="nx">v</span><span class="p">]</span> <span class="k">for</span> <span class="nx">k</span><span class="p">,</span><span class="nx">v</span> <span class="k">of</span> <span class="nx">map1</span>
	</pre></div>             </td>           </tr>                               <tr id="section-62">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-62">&#182;</a>               </div>               <p>Intance constructor. The input parameter <code>point</code> is an array of arrays of numbers 
(i.e. the coordinate matrix) of the class instance in <a href="http://en.wikipedia.org/wiki/Row-major_order">row-major order</a>.
The constructor defines:</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">constructor: </span><span class="nf">(points) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-63">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-63">&#182;</a>               </div>               <ul>
<li>the dimension <code>@rn</code> of the space points, <em>i.e.</em> their number of coordinates;</li>
<li>a dictionary <code>@dict</code> of distinct points, mapping the symbolic representation of a point into the integer <em>point index</em>;</li>
<li>a <code>@map</code> translating from input indexes of points (possibly repeated)  to internal point ids (without repetitions):
<ul><li>mainly useful to <em>automatically</em> glue the discrtete representation of closed manifolds along the boundary of their topological maps</li></ul></li>
<li>the array <code>@verts</code> containing the numeric representation (in fixed-precision) of the class instance;</li>
<li>the number <code>@m</code> of distinct points in the class instance</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="nv">points = </span><span class="nx">points</span> <span class="o">or</span> <span class="p">[]</span>
		<span class="k">if</span> <span class="nx">points</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span>
			<span class="vi">@rn = </span><span class="nx">points</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span>
			<span class="vi">@dict = </span><span class="p">{};</span> <span class="nx">@dict</span><span class="p">[</span><span class="nx">fcode</span><span class="p">(</span><span class="nx">point</span><span class="p">)]</span> <span class="o">=</span> <span class="nx">i</span> <span class="k">for</span> <span class="nx">point</span><span class="p">,</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">points</span>
			<span class="nv">map1 = </span><span class="p">{};</span> <span class="nx">map1</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">decode</span><span class="p">(</span><span class="nx">@dict</span><span class="p">[</span><span class="nx">fcode</span><span class="p">(</span><span class="nx">point</span><span class="p">)])</span>  <span class="k">for</span> <span class="nx">point</span><span class="p">,</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">points</span>
			<span class="p">[</span><span class="nx">map2</span><span class="p">,</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{},</span><span class="mi">0</span><span class="p">];</span> <span class="k">for</span> <span class="nx">pcode</span><span class="p">,</span><span class="nx">pid</span> <span class="k">of</span> <span class="nx">@dict</span>
				<span class="nx">map2</span><span class="p">[</span><span class="nx">decode</span><span class="p">(</span><span class="nx">pid</span><span class="p">)]</span> <span class="o">=</span> <span class="nx">k</span><span class="p">;</span> <span class="nx">k</span> <span class="o">+=</span> <span class="mi">1</span>
			<span class="vi">@map = </span><span class="p">(</span><span class="nx">v</span> <span class="k">for</span> <span class="nx">k</span><span class="p">,</span><span class="nx">v</span> <span class="k">of</span> <span class="nx">mapcomp</span> <span class="nx">map1</span><span class="p">,</span><span class="nx">map2</span><span class="p">)</span>
			<span class="nv">k = </span><span class="mi">0</span><span class="p">;</span> <span class="k">for</span> <span class="nx">pcode</span> <span class="k">of</span> <span class="nx">@dict</span>
				<span class="nx">@dict</span><span class="p">[</span><span class="nx">pcode</span><span class="p">]</span> <span class="o">=</span> <span class="nx">k</span><span class="p">;</span> <span class="nx">k</span> <span class="o">+=</span> <span class="mi">1</span>
			<span class="vi">@verts = </span><span class="p">(</span><span class="nx">uncode</span> <span class="nx">pcode</span> <span class="k">for</span> <span class="nx">pcode</span> <span class="k">of</span> <span class="nx">@dict</span><span class="p">)</span>
			<span class="vi">@m = </span><span class="nx">@verts</span><span class="p">.</span><span class="nx">length</span>
		<span class="k">else</span>
			<span class="vi">@rn = </span><span class="mi">0</span>
			<span class="vi">@dict = </span><span class="p">{}</span>
			<span class="vi">@map = </span><span class="p">[]</span>
			<span class="vi">@verts = </span><span class="p">[]</span>
			<span class="vi">@m = </span><span class="mi">0</span></pre></div>             </td>           </tr>                               <tr id="section-64">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-64">&#182;</a>               </div>               <p>Method used to update the coordinates in all points of a <code>Pointset</code> instance.
The input parameter <code>modify</code> is a function.</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">update: </span><span class="nf">(modify) -&gt;</span>
		<span class="nx">@verts</span><span class="p">[</span><span class="nx">pid</span><span class="p">]</span> <span class="o">=</span> <span class="nx">modify</span> <span class="p">(</span><span class="nx">uncode</span> <span class="nx">pcode</span><span class="p">)</span> <span class="k">for</span> <span class="nx">pcode</span><span class="p">,</span><span class="nx">pid</span> <span class="k">of</span> <span class="nx">@dict</span>
		<span class="vi">@dict = </span><span class="p">{}</span>
		<span class="nx">@dict</span><span class="p">[</span><span class="nx">CODE</span><span class="p">(</span><span class="nx">point</span><span class="p">)]</span> <span class="o">=</span> <span class="nx">pid</span> <span class="k">for</span> <span class="nx">point</span><span class="p">,</span><span class="nx">pid</span> <span class="k">in</span> <span class="nx">@verts</span></pre></div>             </td>           </tr>                               <tr id="section-65">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-65">&#182;</a>               </div>               <p>Method used to embed the <code>Pointset</code> instance in the subspace <em>x_{rn} = x_{rn+1} = ... = x_{rn+n-1} = 0</em>
of the Euclidean space <em>E^{rn+n}</em>, i.e. to add <em>n</em> zero coordinates to all points</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">embed: </span><span class="nf">(n) -&gt;</span> 
		<span class="nx">@rn</span> <span class="o">+=</span> <span class="nx">n</span>
		<span class="nx">@update</span> <span class="nf">(point) -&gt;</span> <span class="nx">CAT</span><span class="p">([</span><span class="nx">point</span><span class="p">,</span> <span class="nx">REPEAT</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="mi">0</span><span class="p">])</span>
		<span class="err">@</span></pre></div>             </td>           </tr>                               <tr id="section-66">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-66">&#182;</a>               </div>               <p>Method used to translate the <code>Pointset</code> instance.
The coordinates specified by <code>indices</code> are affected by the transformation <code>parameters</code></p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">t: </span><span class="nf">(indices, parameters) -&gt;</span>
		<span class="nv">vect = </span><span class="p">(</span><span class="mi">0</span> <span class="k">for</span> <span class="nx">k</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">@rn</span><span class="p">])</span>
		<span class="nx">vect</span><span class="p">[</span><span class="nx">indices</span><span class="p">[</span><span class="nx">h</span><span class="p">]]</span> <span class="o">=</span> <span class="nx">parameters</span><span class="p">[</span><span class="nx">h</span><span class="p">]</span> <span class="k">for</span> <span class="nx">h</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">indices</span><span class="p">.</span><span class="nx">length</span><span class="p">]</span>
		<span class="nx">@update</span> <span class="nf">(point) -&gt;</span> <span class="nx">SUM</span><span class="p">([</span><span class="nx">point</span><span class="p">,</span> <span class="nx">vect</span><span class="p">])</span>
		<span class="err">@</span></pre></div>             </td>           </tr>                               <tr id="section-67">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-67">&#182;</a>               </div>               <p>Method used to scale the <code>Pointset</code> instance.
The coordinates specified by <code>indices</code> are affected by the transformation <code>parameters</code></p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">s: </span><span class="nf">(indices, parameters) -&gt;</span>
		<span class="nv">vect = </span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="nx">k</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">@rn</span><span class="p">])</span>
		<span class="nx">vect</span><span class="p">[</span><span class="nx">indices</span><span class="p">[</span><span class="nx">h</span><span class="p">]]</span> <span class="o">=</span> <span class="nx">parameters</span><span class="p">[</span><span class="nx">h</span><span class="p">]</span> <span class="k">for</span> <span class="nx">h</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">indices</span><span class="p">.</span><span class="nx">length</span><span class="p">]</span>
		<span class="nx">@update</span> <span class="nf">(point) -&gt;</span> <span class="nx">MUL</span><span class="p">([</span><span class="nx">point</span><span class="p">,</span> <span class="nx">vect</span><span class="p">])</span>
		<span class="err">@</span></pre></div>             </td>           </tr>                               <tr id="section-68">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-68">&#182;</a>               </div>               <p>Method used to rotate the <code>Pointset</code> instance.
The <em>two</em> coordinates specified by <code>axes</code> are rotated by <code>angle</code> about the origin.</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">r: </span><span class="nf">(axes, angle) -&gt;</span>
		<span class="nv">mat = </span><span class="nx">numeric</span><span class="p">.</span><span class="nx">identity</span><span class="p">(</span><span class="nx">@rn</span><span class="p">)</span>
		<span class="nv">c = </span><span class="nx">cos</span> <span class="nx">angle</span><span class="p">;</span> <span class="nv">s = </span><span class="nx">sin</span> <span class="nx">angle</span>
		<span class="p">[</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">axes</span>
		<span class="nx">mat</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">c</span><span class="p">;</span> <span class="nx">mat</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="nx">s</span>
		<span class="nx">mat</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">s</span><span class="p">;</span> <span class="nx">mat</span><span class="p">[</span><span class="nx">j</span><span class="p">][</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">c</span>
		<span class="nx">@update</span> <span class="nf">(point) -&gt;</span> <span class="nx">numeric</span><span class="p">.</span><span class="nx">dot</span><span class="p">(</span><span class="nx">mat</span><span class="p">,</span> <span class="nx">point</span><span class="p">)</span>
		<span class="err">@</span></pre></div>             </td>           </tr>                               <tr id="section-69">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-69">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.PointSet = </span><span class="nx">PointSet</span></pre></div>             </td>           </tr>                               <tr id="section-70">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-70">&#182;</a>               </div>               <p><HR> </p>

<h3>Topology class</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-71">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-71">&#182;</a>               </div>               <p>The class is used to store the topological relations between the <em>d</em>-cells of a simplicial complex, 
for all values of <em>d</em> between 0 and the intrinsic dimension of the complex</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">class</span> <span class="nx">Topology</span>
	</pre></div>             </td>           </tr>                               <tr id="section-72">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-72">&#182;</a>               </div>               <p>Intance constructor. The input parameters <code>vertices</code> and cells respectively denote a PointSet instance and
an array of arrays of vertex ids specifying the complex cells of highest dimension
The constructor defines:</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">constructor: </span><span class="nf">(vertices,d_cells) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-73">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-73">&#182;</a>               </div>               <ul>
<li>the dimension <code>@dim</code> of the simplicial complex (also denoted <em>d</em> in the following);</li>
<li>a a array <code>@dictos</code> of <em>d+1</em> dictionaries specifyng the ;</li>
<li>the array <code>@homology</code> containing the numeric representation (in fixed-precision) of the class instance;</li>
<li>the array <code>@cells</code> containing the numeric representation (in fixed-precision) of the class instance;</li>
</ul>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="nv">vertices = </span><span class="nx">vertices</span> <span class="o">or</span> <span class="p">[]</span>
		<span class="nv">d_cells = </span><span class="nx">d_cells</span> <span class="o">or</span> <span class="p">[]</span>
		<span class="vi">@dim = </span><span class="k">if</span> <span class="nx">d_cells</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">then</span> <span class="nx">d_cells</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>
		<span class="nv">d_cells = </span><span class="p">((</span><span class="nx">vertices</span><span class="p">.</span><span class="nx">map</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="k">for</span> <span class="nx">k</span> <span class="k">in</span> <span class="nx">cell</span><span class="p">)</span> <span class="k">for</span> <span class="nx">cell</span> <span class="k">in</span> <span class="nx">d_cells</span><span class="p">)</span>
		<span class="nv">d_cells = </span><span class="p">(</span><span class="nx">cell</span> <span class="k">for</span> <span class="nx">cell</span> <span class="k">in</span> <span class="nx">d_cells</span> <span class="k">when</span> <span class="p">(</span><span class="nx">SET</span> <span class="nx">cell</span><span class="p">).</span><span class="nx">length</span> <span class="o">is</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span>
		<span class="vi">@dictos = </span><span class="nx">mkCellDB</span> <span class="p">(</span><span class="nx">cell_complex</span> <span class="nx">d_cells</span><span class="p">)</span>
		<span class="vi">@homology = </span><span class="nx">homology_maps</span> <span class="nx">@dictos</span>
		<span class="vi">@cells = </span><span class="p">(</span><span class="nx">string2numberList</span> <span class="nx">cell</span> <span class="k">for</span> <span class="nx">cell</span> <span class="k">of</span> <span class="nx">dict</span> <span class="k">for</span> <span class="nx">dict</span> <span class="k">in</span> <span class="nx">@dictos</span><span class="p">)</span>

	
	<span class="nv">revert = </span><span class="nf">(cell) -&gt;</span>
		<span class="nv">len = </span><span class="nx">cell</span><span class="p">.</span><span class="nx">length</span>
		<span class="k">if</span> <span class="nx">len</span> <span class="o">&gt;</span><span class="mi">1</span> <span class="k">then</span> <span class="nx">CAT</span> <span class="p">[</span><span class="nx">cell</span><span class="p">[</span><span class="nx">len</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nx">cell</span><span class="p">[</span><span class="mi">1</span><span class="p">...</span><span class="nx">len</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nx">cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">else</span> <span class="nx">cell</span>
	<span class="nv">remove_duplicates = </span><span class="nf">(hasDupes) -&gt;</span>
		<span class="nv">dict = </span><span class="p">{};</span> <span class="p">(</span><span class="nx">dict</span><span class="p">[</span><span class="nx">CODE</span><span class="p">(</span><span class="nx">item</span><span class="p">)]</span> <span class="o">=</span> <span class="nx">item</span> <span class="k">for</span> <span class="nx">item</span> <span class="k">in</span> <span class="nx">hasDupes</span> <span class="o">\</span>
			<span class="k">when</span> <span class="o">not</span> <span class="nx">dict</span><span class="p">[</span><span class="nx">CODE</span><span class="p">(</span><span class="nx">revert</span> <span class="nx">item</span><span class="p">)]</span><span class="o">?</span> <span class="o">and</span> <span class="o">not</span> <span class="nx">dict</span><span class="p">[</span><span class="nx">CODE</span><span class="p">(</span><span class="nx">item</span><span class="p">)]</span><span class="o">?</span><span class="p">)</span>
	<span class="nv">rotate = </span><span class="nf">(cell) -&gt;</span>
		<span class="k">if</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">then</span> <span class="nx">CAT</span> <span class="p">[</span><span class="nx">cell</span><span class="p">[</span><span class="mi">1</span><span class="p">...</span><span class="nx">cell</span><span class="p">.</span><span class="nx">length</span><span class="p">],[</span><span class="nx">cell</span><span class="p">[</span><span class="mi">0</span><span class="p">]]]</span> <span class="k">else</span> <span class="nx">cell</span>
	<span class="nv">facets = </span><span class="nf">(cell) -&gt;</span> 
		<span class="nv">out = </span><span class="p">[];</span> <span class="k">for</span> <span class="nx">h</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">cell</span><span class="p">.</span><span class="nx">length</span><span class="p">]</span>
			<span class="nv">facet = </span><span class="p">(</span><span class="nx">k</span> <span class="k">for</span> <span class="nx">k</span><span class="p">,</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">cell</span> <span class="k">when</span> <span class="nx">i</span> <span class="o">isnt</span> <span class="nx">h</span><span class="p">)</span>
			<span class="nx">out</span><span class="p">.</span><span class="nx">push</span>  <span class="k">if</span> <span class="nx">h</span><span class="o">%</span><span class="mi">2</span> <span class="o">is</span> <span class="mi">1</span> <span class="k">then</span> <span class="nx">revert</span> <span class="nx">facet</span> <span class="k">else</span> <span class="nx">facet</span>
		<span class="nx">out</span>
	<span class="nv">skeltn = </span><span class="nf">(h_cells) -&gt;</span> 
		<span class="nx">remove_duplicates</span> <span class="nx">CAT</span> <span class="p">(</span><span class="nx">facets</span> <span class="nx">cell</span> <span class="k">for</span> <span class="nx">cell</span> <span class="k">in</span> <span class="nx">h_cells</span><span class="p">)</span>
	<span class="nv">cell_complex = </span><span class="nf">(d_cells) -&gt;</span>
		<span class="k">if</span> <span class="nx">d_cells</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span>
			<span class="nv">dim = </span><span class="nx">d_cells</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span></pre></div>             </td>           </tr>                               <tr id="section-74">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-74">&#182;</a>               </div>               <p>ASSERT  dim == 0</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="k">if</span> <span class="nx">dim</span> <span class="o">&gt;=</span> <span class="mi">0</span>
				<span class="nv">cells = </span><span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">dim</span><span class="p">)</span>
				<span class="nx">cells</span><span class="p">[</span><span class="nx">dim</span><span class="p">]</span> <span class="o">=</span> <span class="nx">d_cells</span>
				<span class="k">if</span> <span class="nx">dim</span> <span class="o">&gt;</span> <span class="mi">0</span> 
					<span class="nx">cells</span><span class="p">[</span><span class="nx">h</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">skeltn</span> <span class="nx">cells</span><span class="p">[</span><span class="nx">h</span><span class="p">]</span> <span class="k">for</span> <span class="nx">h</span> <span class="k">in</span> <span class="p">[</span><span class="nx">dim</span><span class="p">..</span><span class="mi">1</span><span class="p">]</span>
				<span class="nx">cells</span>
			<span class="k">else</span>
				<span class="nv">cells = </span><span class="p">[[]]</span>
		<span class="k">else</span>
			<span class="nv">dim = </span><span class="mi">0</span>
			<span class="nv">cells = </span><span class="p">[[]]</span>
	<span class="nv">mkCellDB = </span><span class="nf">(complex) -&gt;</span>
		<span class="nv">complex = </span><span class="nx">complex</span> <span class="o">or</span> <span class="p">[]</span>
		<span class="nv">dictos = </span><span class="p">[]</span>
		<span class="k">for</span> <span class="nx">skel</span><span class="p">,</span><span class="nx">d</span> <span class="k">in</span> <span class="nx">complex</span>
			<span class="nx">dictos</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span> <span class="o">=</span> <span class="p">{};</span> <span class="nx">dictos</span><span class="p">[</span><span class="nx">d</span><span class="p">][</span><span class="nx">CODE</span><span class="p">(</span><span class="nx">cell</span><span class="p">)]</span> <span class="o">=</span> <span class="nx">k</span> <span class="k">for</span> <span class="nx">cell</span><span class="p">,</span><span class="nx">k</span> <span class="k">in</span> <span class="nx">skel</span>
		<span class="nx">dictos</span>
	<span class="nv">homology_maps = </span><span class="nf">(dictos) -&gt;</span>
		<span class="k">if</span> <span class="nx">dictos</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span>
			<span class="nv">dim = </span><span class="nx">dictos</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="nv">d = </span><span class="mi">1</span>
			<span class="nv">homology = </span><span class="p">([]</span> <span class="k">for</span> <span class="nx">i</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">..</span><span class="nx">dim</span><span class="p">])</span>
			<span class="k">if</span> <span class="nx">dim</span> <span class="o">&gt;</span> <span class="mi">1</span>
				<span class="nv">skel = </span><span class="nx">dictos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
				<span class="k">for</span> <span class="nx">cell</span> <span class="k">of</span> <span class="nx">skel</span>
					<span class="nv">SIMPLEX = </span><span class="nx">string2numberList</span> <span class="nx">cell</span>
					<span class="nx">homology</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">push</span> <span class="p">([</span><span class="nx">skel</span><span class="p">[</span><span class="nx">cell</span><span class="p">],</span> <span class="nx">facet</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">for</span> <span class="nx">facet</span> <span class="k">in</span> <span class="nx">facets</span> <span class="nx">SIMPLEX</span><span class="p">)</span>
				<span class="nx">homology</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">CAT</span> <span class="nx">homology</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
				<span class="k">for</span> <span class="nx">skel</span> <span class="k">in</span> <span class="nx">dictos</span><span class="p">[</span><span class="mi">2</span><span class="p">..</span><span class="nx">dim</span><span class="p">]</span>
					<span class="nx">d</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
					<span class="k">for</span> <span class="nx">cell</span> <span class="k">of</span> <span class="nx">skel</span>
						<span class="k">for</span> <span class="nx">facet</span> <span class="k">in</span> <span class="nx">facets</span> <span class="nx">string2numberList</span> <span class="nx">cell</span>
							<span class="k">if</span> <span class="nx">dictos</span><span class="p">[</span><span class="nx">d</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="nx">CODE</span><span class="p">(</span><span class="nx">facet</span><span class="p">)]</span><span class="o">?</span>
								<span class="nv">key = </span><span class="nx">dictos</span><span class="p">[</span><span class="nx">d</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="nx">CODE</span><span class="p">(</span><span class="nx">facet</span><span class="p">)]</span>
							<span class="k">else</span>
								<span class="nv">key = </span><span class="nx">dictos</span><span class="p">[</span><span class="nx">d</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="nx">CODE</span><span class="p">(</span><span class="nx">revert</span><span class="p">(</span><span class="nx">facet</span><span class="p">))]</span>
							<span class="nx">homology</span><span class="p">[</span><span class="nx">d</span><span class="p">].</span><span class="nx">push</span> <span class="p">[</span><span class="nx">skel</span><span class="p">[</span><span class="nx">cell</span><span class="p">],</span> <span class="nx">key</span><span class="p">]</span>
			<span class="nx">homology</span>
		<span class="k">else</span> <span class="p">[]</span>
	
<span class="nv">root.Topology = </span><span class="nx">Topology</span></pre></div>             </td>           </tr>                               <tr id="section-75">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-75">&#182;</a>               </div>               <p>///////////////////////////////////////////////////////////////////////////////</p>             </td>             <td class="code">               <div class="highlight"><pre>	
<span class="k">class</span> <span class="nx">SimplicialComplex</span>

	<span class="nv">vertexFilter = </span><span class="nf">(points,d_cells) -&gt;</span>
		<span class="nv">numbers = </span><span class="nf">(a,b) -&gt;</span> <span class="nx">a</span><span class="o">-</span><span class="nx">b</span>
		<span class="nv">verts = </span><span class="p">(</span><span class="nx">SET</span> <span class="nx">CAT</span> <span class="nx">d_cells</span><span class="p">).</span><span class="nx">sort</span><span class="p">(</span><span class="nx">numbers</span><span class="p">)</span>
		<span class="nv">inverts = </span><span class="p">[];</span> <span class="nx">inverts</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span><span class="o">=</span><span class="nx">k</span> <span class="k">for</span> <span class="nx">i</span><span class="p">,</span><span class="nx">k</span> <span class="k">in</span> <span class="nx">verts</span>
		<span class="nv">points = </span><span class="p">(</span><span class="nx">point</span> <span class="k">for</span> <span class="nx">point</span><span class="p">,</span><span class="nx">k</span> <span class="k">in</span> <span class="nx">points</span> <span class="k">when</span> <span class="nx">inverts</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span><span class="o">?</span><span class="p">)</span>
		<span class="nv">d_cells = </span><span class="p">((</span><span class="nx">inverts</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="k">for</span> <span class="nx">k</span> <span class="k">in</span> <span class="nx">cell</span><span class="p">)</span> <span class="k">for</span> <span class="nx">cell</span> <span class="k">in</span> <span class="nx">d_cells</span><span class="p">)</span>
		<span class="p">[</span><span class="nx">points</span><span class="p">,</span><span class="nx">d_cells</span><span class="p">]</span>

	<span class="nv">constructor: </span><span class="nf">(points,d_cells,filter=true) -&gt;</span>
		<span class="nv">points = </span><span class="nx">points</span> <span class="o">or</span> <span class="p">[]</span>
		<span class="nv">d_cells = </span><span class="nx">d_cells</span> <span class="o">or</span> <span class="p">[]</span>
		<span class="k">if</span> <span class="nx">filter</span> <span class="k">then</span> <span class="p">[</span><span class="nx">points</span><span class="p">,</span><span class="nx">d_cells</span><span class="p">]</span> <span class="o">=</span> <span class="nx">vertexFilter</span><span class="p">(</span><span class="nx">points</span><span class="p">,</span><span class="nx">d_cells</span><span class="p">)</span>
		<span class="vi">@vertices = </span><span class="k">new</span> <span class="nx">PointSet</span><span class="p">(</span><span class="nx">points</span><span class="p">)</span>
		<span class="vi">@faces = </span><span class="k">new</span> <span class="nx">Topology</span><span class="p">(</span><span class="nx">@vertices</span><span class="p">,</span><span class="nx">d_cells</span><span class="p">)</span>
		<span class="err">@</span>

	<span class="nv">embed: </span><span class="nf">(n) -&gt;</span> <span class="nx">@vertices</span><span class="p">.</span><span class="nx">embed</span><span class="p">(</span><span class="nx">n</span><span class="p">);</span> <span class="err">@</span>
	<span class="nv">t: </span><span class="nf">(indices,values) -&gt;</span> <span class="nx">@vertices</span><span class="p">.</span><span class="nx">t</span><span class="p">(</span><span class="nx">indices</span><span class="p">,</span><span class="nx">values</span><span class="p">);</span> <span class="err">@</span>
	<span class="nv">s: </span><span class="nf">(indices,values) -&gt;</span> <span class="nx">@vertices</span><span class="p">.</span><span class="nx">s</span><span class="p">(</span><span class="nx">indices</span><span class="p">,</span><span class="nx">values</span><span class="p">);</span> <span class="err">@</span>
	<span class="nv">r: </span><span class="nf">(axes, angle) -&gt;</span> <span class="nx">@vertices</span><span class="p">.</span><span class="nx">r</span><span class="p">(</span><span class="nx">axes</span><span class="p">,</span> <span class="nx">angle</span><span class="p">);</span> <span class="err">@</span>

<span class="nv">root.SimplicialComplex = </span><span class="nx">SimplicialComplex</span></pre></div>             </td>           </tr>                               <tr id="section-76">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-76">&#182;</a>               </div>               <p>///////////////////////////////////////////////////////////////////////////////</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-77">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-77">&#182;</a>               </div>               <p><strong>EMBED</strong> embeds a d-polyhedron into the subspace xd+1 = ¬∑¬∑¬∑ = xd+n = 0 of E^d+n</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.EMBED = EMBED = </span><span class="nf">(n) -&gt;</span> <span class="nf">(obj) -&gt;</span> <span class="p">(</span><span class="nx">CLONE</span> <span class="nx">obj</span><span class="p">).</span><span class="nx">embed</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-78">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-78">&#182;</a>               </div>               <p><strong>T</strong> dim-indep. translation tensor. indices of the coordinates affected by the transformation</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.T = T = </span><span class="nf">(indices,values) -&gt;</span> <span class="nf">(obj) -&gt;</span> <span class="p">(</span><span class="nx">CLONE</span> <span class="nx">obj</span><span class="p">).</span><span class="nx">t</span><span class="p">(</span><span class="nx">indices</span><span class="p">,</span><span class="nx">values</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-79">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-79">&#182;</a>               </div>               <p><strong>S</strong> dim-indep. scaling tensor. indices of the coordinates affected by the transformation</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.S = S = </span><span class="nf">(indices,values) -&gt;</span> <span class="nf">(obj) -&gt;</span> <span class="p">(</span><span class="nx">CLONE</span> <span class="nx">obj</span><span class="p">).</span><span class="nx">s</span><span class="p">(</span><span class="nx">indices</span><span class="p">,</span><span class="nx">values</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-80">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-80">&#182;</a>               </div>               <p><strong>R</strong> dim-indep. rotation tensor. axes is the coordinate pair affected by the transformation. 
The rotation angle is given in radians</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.R = R = </span><span class="nf">(axes,angle) -&gt;</span> 
	<span class="nx">PRINT</span> <span class="s2">&quot;axes, angle =&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nx">axes</span><span class="p">,</span> <span class="nx">angle</span><span class="p">]</span>
	<span class="nf">(obj) -&gt;</span> <span class="p">(</span><span class="nx">CLONE</span> <span class="nx">obj</span><span class="p">).</span><span class="nx">R</span><span class="p">(</span><span class="nx">axes</span><span class="p">,</span> <span class="nx">angle</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-81">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-81">&#182;</a>               </div>               <p><strong>CENTROID</strong> returns a point, i.e. the barycenter of obj</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.CENTROID = CENTROID = </span><span class="nf">(obj) -&gt;</span> <span class="nf">(face) -&gt;</span>
	<span class="nv">A = </span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">vertices</span><span class="p">.</span><span class="nx">verts</span><span class="p">[</span><span class="nx">v</span><span class="p">]</span>  <span class="k">for</span> <span class="nx">v</span> <span class="k">in</span> <span class="nx">face</span><span class="p">)</span>
	<span class="nv">C = </span><span class="nx">REPEAT</span><span class="p">(</span><span class="nx">A</span><span class="p">.</span><span class="nx">length</span><span class="p">)(</span><span class="mf">1.0</span><span class="o">/</span><span class="nx">A</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span>
	<span class="nv">point = </span><span class="nx">numeric</span><span class="p">.</span><span class="nx">dot</span><span class="p">(</span><span class="nx">C</span><span class="p">,</span><span class="nx">A</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-82">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-82">&#182;</a>               </div>               <p><strong>EXTRUDE</strong> return a simplicial d+1-complex triangulating the d-dimensional obj. 
hlist is a list of displacements, where negative numbers stand for empty spaces</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.EXTRUDE = EXTRUDE = </span><span class="nf">(hlist) -&gt;</span> <span class="nf">(obj) -&gt;</span> 

	<span class="nv">coords_distribute = </span><span class="nf">(x) -&gt;</span>
		<span class="nv">out = </span><span class="nx">CAT</span><span class="p">(</span> <span class="nx">AA</span><span class="p">(</span><span class="nx">AR</span><span class="p">)(</span><span class="nx">DISTR</span><span class="p">(</span><span class="nx">e</span><span class="p">))</span> <span class="k">for</span> <span class="nx">e</span> <span class="k">in</span> <span class="nx">x</span><span class="p">)</span>
	<span class="nv">shift = </span><span class="nf">(n, listoflists) -&gt;</span> <span class="p">(</span><span class="nx">x</span><span class="o">+</span><span class="nx">n</span> <span class="k">for</span> <span class="nx">x</span> <span class="k">in</span> <span class="nx">seq</span><span class="p">)</span> <span class="k">for</span> <span class="nx">seq</span> <span class="k">in</span> <span class="nx">listoflists</span>
	<span class="nv">subcomplex = </span><span class="nf">(d,args) -&gt;</span>
		<span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="nx">i</span><span class="p">...</span><span class="nx">i</span><span class="o">+</span><span class="nx">d</span><span class="p">]</span> <span class="k">for</span> <span class="nx">i</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">..</span><span class="nx">args</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="nx">d</span><span class="p">])</span>

	<span class="nv">cells = </span><span class="nx">CLONE</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">faces</span><span class="p">.</span><span class="nx">cells</span>
	<span class="nv">dim = </span><span class="nx">CLONE</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">faces</span><span class="p">.</span><span class="nx">dim</span>
	<span class="nv">verts = </span><span class="nx">CLONE</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">vertices</span><span class="p">.</span><span class="nx">verts</span>
	<span class="nv">lastcoords = </span><span class="nx">PROGRESSIVE_SUM</span> <span class="p">(</span><span class="nx">AA</span><span class="p">)(</span><span class="nx">abs</span><span class="p">)(</span><span class="nx">hlist</span><span class="p">)</span>
	<span class="k">if</span> <span class="nx">dim</span> <span class="o">&lt;=</span> <span class="mi">0</span>
		<span class="nv">cells = </span><span class="p">[[],[]]</span>
		<span class="nv">vertices = </span><span class="nx">AA</span><span class="p">(</span><span class="nx">LIST</span><span class="p">)(</span><span class="nx">lastcoords</span><span class="p">)</span>
		<span class="nx">cells</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">([</span><span class="nx">i</span><span class="p">,</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="nx">i</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">hlist</span><span class="p">.</span><span class="nx">length</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
	<span class="k">else</span>
		<span class="nv">simplexes = </span><span class="nx">cells</span><span class="p">[</span><span class="nx">dim</span><span class="p">]</span>
		<span class="nv">nverts = </span><span class="nx">verts</span><span class="p">.</span><span class="nx">length</span>
		<span class="nv">nsteps = </span><span class="nx">lastcoords</span><span class="p">.</span><span class="nx">length</span>
		<span class="nv">sliced_vertices = </span><span class="p">(</span><span class="nx">REPLICA</span> <span class="nx">nsteps</span><span class="p">)</span> <span class="p">[</span><span class="nx">verts</span><span class="p">]</span>
		<span class="nv">vertices = </span><span class="nx">coords_distribute</span><span class="p">(</span><span class="nx">TRANS</span><span class="p">([</span><span class="nx">REPEAT</span><span class="p">(</span><span class="nx">nsteps</span><span class="p">)(</span><span class="nx">verts</span><span class="p">),</span> <span class="nx">lastcoords</span><span class="p">]))</span>
		<span class="nv">extruded_simplices = </span><span class="p">[]</span>
		<span class="k">for</span> <span class="nx">cell</span> <span class="k">in</span> <span class="nx">simplexes</span>
			<span class="nv">vertPtrs = </span><span class="nx">CAT</span><span class="p">([</span><span class="nx">cell</span><span class="p">,</span> <span class="nx">cell</span><span class="p">.</span><span class="nx">map</span> <span class="nf">(x) -&gt;</span> <span class="nx">x</span><span class="o">+</span><span class="nx">nverts</span><span class="p">])</span>
			<span class="nx">extruded_simplices</span><span class="p">.</span><span class="nx">push</span> <span class="nx">subcomplex</span><span class="p">(</span><span class="nx">dim</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="nx">vertPtrs</span><span class="p">)</span>
		<span class="nv">final_simplices = </span><span class="p">[]</span>
		<span class="k">for</span> <span class="nx">i</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">..</span><span class="nx">nsteps</span><span class="p">]</span>
			<span class="k">if</span> <span class="nx">hlist</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span>
				<span class="nv">simplex_layer = </span><span class="nx">shift</span> <span class="nx">nverts</span><span class="o">*</span><span class="nx">i</span><span class="p">,</span> <span class="nx">CAT</span> <span class="nx">extruded_simplices</span>
				<span class="nx">final_simplices</span><span class="p">.</span><span class="nx">push</span> <span class="nx">simplex_layer</span>
		<span class="nv">cells = </span><span class="nx">CAT</span> <span class="nx">final_simplices</span>
	<span class="k">new</span> <span class="nx">SimplicialComplex</span><span class="p">(</span><span class="nx">vertices</span><span class="p">,</span> <span class="nx">cells</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-83">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-83">&#182;</a>               </div>               <p><strong>SIMPLEXGRID</strong> returns a d-dimensional grid of simplices</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.SIMPLEXGRID = SIMPLEXGRID = </span><span class="nf">(args) -&gt;</span>
	<span class="nv">hlist = </span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
	<span class="nv">lastcoords = </span><span class="nx">PROGRESSIVE_SUM</span> <span class="nx">AA</span><span class="p">(</span><span class="nx">abs</span><span class="p">)(</span><span class="nx">hlist</span><span class="p">)</span>
	<span class="nv">verts = </span><span class="nx">AA</span><span class="p">(</span><span class="nx">LIST</span><span class="p">)(</span><span class="nx">lastcoords</span><span class="p">)</span>
	<span class="nv">cells = </span><span class="p">([</span><span class="nx">i</span><span class="p">,</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="nx">i</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">hlist</span><span class="p">.</span><span class="nx">length</span><span class="p">]</span> <span class="k">when</span> <span class="nx">hlist</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">)</span>
	<span class="nv">complex = </span><span class="k">new</span> <span class="nx">SimplicialComplex</span><span class="p">(</span><span class="nx">verts</span><span class="p">,</span><span class="nx">cells</span><span class="p">)</span>
	<span class="k">for</span> <span class="nx">hlist</span> <span class="k">in</span> <span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">...</span><span class="nx">args</span><span class="p">.</span><span class="nx">length</span><span class="p">]</span>
		<span class="nv">complex = </span><span class="nx">EXTRUDE</span><span class="p">(</span><span class="nx">hlist</span><span class="p">)(</span><span class="nx">complex</span><span class="p">)</span>
	<span class="nx">complex</span></pre></div>             </td>           </tr>                               <tr id="section-84">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-84">&#182;</a>               </div>               <p><strong>FREE</strong> transforms a simplicial d-complex into a list of simplicial complexes (one for d-simplex)</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.FREE = FREE = </span><span class="nf">(obj) -&gt;</span>
	<span class="nv">d = </span><span class="nx">obj</span><span class="p">.</span><span class="nx">faces</span><span class="p">.</span><span class="nx">dim</span>
	<span class="nv">simplices = </span><span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">vertices</span><span class="p">.</span><span class="nx">verts</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="k">for</span> <span class="nx">k</span> <span class="k">in</span> <span class="nx">cell</span> <span class="k">for</span> <span class="nx">cell</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">faces</span><span class="p">.</span><span class="nx">cells</span><span class="p">[</span><span class="nx">d</span><span class="p">])</span>
	<span class="nv">out = </span><span class="p">[];</span> <span class="k">for</span> <span class="nx">SIMPLEX</span> <span class="k">in</span> <span class="nx">simplices</span>
		<span class="nv">outsimplex = </span><span class="k">new</span> <span class="nx">SimplicialComplex</span><span class="p">(</span><span class="nx">SIMPLEX</span><span class="p">,[[</span><span class="mi">0</span><span class="p">..</span><span class="nx">d</span><span class="p">]])</span>
		<span class="nx">out</span><span class="p">.</span><span class="nx">push</span> <span class="nx">outsimplex</span>
	<span class="nx">out</span></pre></div>             </td>           </tr>                               <tr id="section-85">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-85">&#182;</a>               </div>               <p><strong>EXPLODE</strong> generates an exploded copy of a simplicial complex scene</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.EXPLODE = EXPLODE = </span><span class="nf">(args) -&gt;</span> <span class="nf">(scene) -&gt;</span>
	<span class="nv">face = </span><span class="nf">() -&gt;</span> <span class="nx">item</span><span class="p">.</span><span class="nx">faces</span><span class="p">.</span><span class="nx">cells</span><span class="p">[</span><span class="nx">item</span><span class="p">.</span><span class="nx">faces</span><span class="p">.</span><span class="nx">dim</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
	<span class="nv">centers = </span><span class="p">(</span><span class="nx">CENTROID</span><span class="p">(</span><span class="nx">item</span><span class="p">)(</span><span class="nx">face</span><span class="p">())</span> <span class="k">for</span> <span class="nx">item</span> <span class="k">in</span> <span class="nx">scene</span><span class="p">)</span>
	<span class="nv">scaledCenters = </span><span class="p">(</span><span class="nx">MUL</span><span class="p">([</span><span class="nx">args</span><span class="p">,</span><span class="nx">center</span><span class="p">])</span> <span class="k">for</span> <span class="nx">center</span> <span class="k">in</span> <span class="nx">centers</span><span class="p">)</span>
	<span class="nv">translVectors = </span><span class="p">(</span><span class="nx">SUB</span><span class="p">(</span><span class="nx">pair</span><span class="p">)</span> <span class="k">for</span> <span class="nx">pair</span> <span class="k">in</span> <span class="nx">TRANS</span><span class="p">([</span><span class="nx">scaledCenters</span><span class="p">,</span> <span class="nx">centers</span><span class="p">]))</span>
	<span class="nx">scene</span><span class="p">[</span><span class="nx">k</span><span class="p">].</span><span class="nx">t</span><span class="p">([</span><span class="mi">0</span><span class="p">...</span><span class="nx">v</span><span class="p">.</span><span class="nx">length</span><span class="p">],</span><span class="nx">v</span><span class="p">)</span> <span class="k">for</span> <span class="nx">v</span><span class="p">,</span><span class="nx">k</span> <span class="k">in</span> <span class="nx">translVectors</span></pre></div>             </td>           </tr>                               <tr id="section-86">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-86">&#182;</a>               </div>               <p><strong>SKELETON</strong> returns the dim -dimensional skeleton of a simplicial complex obj</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.SKELETON = SKELETON = </span><span class="nf">(dim) -&gt;</span> <span class="nf">(obj) -&gt;</span>
	<span class="nv">verts = </span><span class="nx">obj</span><span class="p">.</span><span class="nx">vertices</span><span class="p">.</span><span class="nx">verts</span>
	<span class="nv">faces_d = </span><span class="nx">obj</span><span class="p">.</span><span class="nx">faces</span><span class="p">.</span><span class="nx">cells</span><span class="p">[</span><span class="nx">dim</span><span class="p">]</span>
	<span class="k">new</span> <span class="nx">SimplicialComplex</span><span class="p">(</span><span class="nx">verts</span><span class="p">,</span><span class="nx">faces_d</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-87">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-87">&#182;</a>               </div>               <p><strong>BOUNDARY</strong> returns the oriented (d-1)-simplicial complex of a simplicial d-complex pol</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.BOUNDARY = BOUNDARY = </span><span class="nf">(pol) -&gt;</span>
	<span class="nv">obj = </span><span class="nx">CLONE</span> <span class="nx">pol</span>
	<span class="nv">d = </span><span class="nx">obj</span><span class="p">.</span><span class="nx">faces</span><span class="p">.</span><span class="nx">dim</span>
	<span class="nv">facets = </span><span class="nx">obj</span><span class="p">.</span><span class="nx">faces</span><span class="p">.</span><span class="nx">cells</span><span class="p">[</span><span class="nx">d</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
	<span class="k">if</span> <span class="nx">d</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="k">then</span> <span class="k">return</span> <span class="k">new</span> <span class="nx">SimplicialComplex</span><span class="p">([],</span> <span class="p">[])</span>
	<span class="nv">vertices = </span><span class="nx">obj</span><span class="p">.</span><span class="nx">vertices</span><span class="p">.</span><span class="nx">verts</span>  <span class="c1"># input verts</span>
	
	<span class="nv">simplexMatrix = </span><span class="nf">(cell) -&gt;</span> <span class="p">(</span><span class="nx">AR</span><span class="p">([</span><span class="nx">vertices</span><span class="p">[</span><span class="nx">k</span><span class="p">],</span><span class="mf">1.0</span><span class="p">])</span> <span class="k">for</span> <span class="nx">k</span> <span class="k">in</span> <span class="nx">cell</span><span class="p">)</span>
	<span class="nv">sign = </span><span class="nf">(number) -&gt;</span> <span class="k">if</span> <span class="nx">number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">then</span> <span class="mi">1</span> <span class="k">else</span> <span class="k">if</span> <span class="nx">number</span> <span class="o">isnt</span> <span class="mi">0</span> <span class="k">then</span> <span class="o">-</span><span class="mi">1</span>
	<span class="nv">volume = </span><span class="nf">(cell) -&gt;</span>  <span class="nx">numeric</span><span class="p">.</span><span class="nx">det</span> <span class="nx">simplexMatrix</span><span class="p">(</span><span class="nx">cell</span><span class="p">)</span>
	<span class="nv">orientation = </span><span class="nf">(d,d_cells) -&gt;</span>
		<span class="k">if</span> <span class="nx">d</span> <span class="o">==</span> <span class="nx">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span>		<span class="c1"># solid complex</span>
			<span class="nv">out = </span><span class="p">(</span><span class="nx">sign</span> <span class="nx">volume</span><span class="p">(</span><span class="nx">cell</span><span class="p">)</span> <span class="k">for</span> <span class="nx">cell</span> <span class="k">in</span> <span class="nx">d_cells</span><span class="p">)</span>
		<span class="k">else</span>				<span class="c1"># embedded complex</span>
			<span class="nv">out = </span><span class="p">(</span><span class="s2">&quot;numeric.det(somethingelse)&quot;</span> <span class="k">for</span> <span class="nx">cell</span> <span class="k">in</span> <span class="nx">d_cells</span><span class="p">)</span>  <span class="c1"># DEBUG (choose minor with det(minor != 0	))</span>
		<span class="nx">out</span>
	<span class="nv">invertOrientation = </span><span class="nf">(facet) -&gt;</span>
		<span class="nv">newFacet = </span><span class="nx">CLONE</span> <span class="nx">facet</span>
		<span class="p">[</span><span class="nx">newFacet</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nx">newFacet</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="nx">newFacet</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="nx">newFacet</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
		<span class="nx">newFacet</span>

	<span class="nv">dictos = </span><span class="nx">obj</span><span class="p">.</span><span class="nx">faces</span><span class="p">.</span><span class="nx">dictos</span>
	<span class="nv">hom = </span><span class="nx">obj</span><span class="p">.</span><span class="nx">faces</span><span class="p">.</span><span class="nx">homology</span>
	<span class="nv">incidence = </span><span class="p">(</span><span class="mi">0</span> <span class="k">for</span> <span class="nx">k</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">facets</span><span class="p">.</span><span class="nx">length</span><span class="p">])</span>
	<span class="nv">father = </span><span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">facets</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span>
	<span class="k">for</span> <span class="nx">pair</span> <span class="k">in</span> <span class="nx">hom</span><span class="p">[</span><span class="nx">d</span><span class="p">]</span>
		<span class="nx">incidence</span><span class="p">[</span><span class="nx">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>
		<span class="nx">father</span><span class="p">[</span><span class="nx">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="nx">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
	<span class="nv">boundary_pairs = </span><span class="nx">TRANS</span><span class="p">([</span><span class="nx">k</span><span class="p">,</span><span class="nx">father</span><span class="p">[</span><span class="nx">k</span><span class="p">]]</span> <span class="k">for</span> <span class="nx">k</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">facets</span><span class="p">.</span><span class="nx">length</span><span class="p">]</span> <span class="k">when</span> <span class="nx">incidence</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">is</span> <span class="mi">1</span><span class="p">)</span>
	<span class="nv">d_faces = </span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">faces</span><span class="p">.</span><span class="nx">cells</span><span class="p">[</span><span class="nx">d</span><span class="p">][</span><span class="nx">k</span><span class="p">]</span> <span class="k">for</span> <span class="nx">k</span> <span class="k">in</span> <span class="nx">boundary_pairs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
	<span class="nv">facets = </span> <span class="p">(</span><span class="nx">obj</span><span class="p">.</span><span class="nx">faces</span><span class="p">.</span><span class="nx">cells</span><span class="p">[</span><span class="nx">d</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="nx">k</span><span class="p">]</span> <span class="k">for</span> <span class="nx">k</span> <span class="k">in</span> <span class="nx">boundary_pairs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
	<span class="nv">boundary_signs = </span><span class="nx">orientation</span><span class="p">(</span><span class="nx">d</span><span class="p">,</span><span class="nx">d_faces</span><span class="p">)</span>   
	<span class="k">for</span> <span class="nx">facet</span><span class="p">,</span><span class="nx">k</span> <span class="k">in</span> <span class="nx">facets</span> 
		<span class="k">if</span> <span class="nx">boundary_signs</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span>
			<span class="nx">facets</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">invertOrientation</span><span class="p">(</span><span class="nx">facet</span><span class="p">)</span>
		<span class="k">else</span>
			<span class="nx">facets</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="o">=</span> <span class="nx">facet</span>
	<span class="k">new</span> <span class="nx">SimplicialComplex</span><span class="p">(</span><span class="nx">vertices</span><span class="p">,</span><span class="nx">facets</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-88">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-88">&#182;</a>               </div>               <p>///////////////////////////////////////////////////////////////////////////////</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-89">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-89">&#182;</a>               </div>               <p>root.STRUCT = STRUCT = (args) -> TODO</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-90">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-90">&#182;</a>               </div>               <p>///////////////////////////////////////////////////////////////////////////////</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-91">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-91">&#182;</a>               </div>               <p>Idnt identity matrix constructor</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.IDNT = IDNT = </span><span class="nf">(d) -&gt;</span> <span class="nx">numeric</span><span class="p">.</span><span class="nx">identity</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-92">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-92">&#182;</a>               </div>               <p><strong>CUBOID</strong> dimension-independent interval generator. 
sides is the sequence of side sizes on coordinate directions</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.CUBOID = CUBOID = </span><span class="nf">(sides) -&gt;</span> <span class="nx">SIMPLEXGRID</span> <span class="nx">AA</span><span class="p">(</span><span class="nx">LIST</span><span class="p">)(</span><span class="nx">sides</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-93">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-93">&#182;</a>               </div>               <p><strong>CUBE</strong> generator of the d-hexahedron of unit sides, with a vertex on the origin</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.CUBE = CUBE = </span><span class="nf">(d) -&gt;</span> <span class="nx">CUBOID</span><span class="p">(</span><span class="nx">REPEAT</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span></pre></div>             </td>           </tr>                               <tr id="section-94">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-94">&#182;</a>               </div>               <p><strong>SIMPLEX</strong> generator of the simplex œÉ^d ‚â° conv({e_i} ‚à™ {0}) ‚äÇ R^d,1‚â§i‚â§d</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.SIMPLEX = SIMPLEX = </span><span class="nf">(d) -&gt;</span> 
	<span class="nv">vertices = </span><span class="nx">CAT</span> <span class="p">[[(</span><span class="mi">0</span> <span class="k">for</span> <span class="nx">k</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">d</span><span class="p">])],</span> <span class="nx">IDNT</span><span class="p">(</span><span class="nx">d</span><span class="p">)]</span>
	<span class="nv">cells = </span><span class="p">[[</span><span class="mi">0</span><span class="p">..</span><span class="nx">d</span><span class="p">]]</span>
	<span class="k">new</span> <span class="nx">SimplicialComplex</span><span class="p">(</span><span class="nx">vertices</span><span class="p">,</span> <span class="nx">cells</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-95">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-95">&#182;</a>               </div>               <p><strong>POLYLINE</strong> generator of 1D connected complexes from the points sequence</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.POLYLINE = POLYLINE = </span><span class="nf">(points) -&gt;</span> 
	<span class="nv">cells = </span><span class="p">([</span><span class="nx">k</span><span class="p">,</span><span class="nx">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="nx">k</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">points</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
	<span class="k">new</span> <span class="nx">SimplicialComplex</span><span class="p">(</span><span class="nx">points</span><span class="p">,</span><span class="nx">cells</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-96">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-96">&#182;</a>               </div>               <p>TRIANGLES_TRIP  multidimensional primitive giving a complex of oriented triangles from d-points</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.TRIANGLESTRIP = TRIANGLESTRIP = </span><span class="nf">(points) -&gt;</span>
	<span class="nv">cells = </span><span class="p">((</span><span class="k">if</span> <span class="nx">k</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">then</span> <span class="p">[</span><span class="nx">k</span><span class="p">,</span><span class="nx">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nx">k</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="k">else</span> <span class="p">[</span><span class="nx">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nx">k</span><span class="p">,</span><span class="nx">k</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="nx">k</span> <span class="k">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">...</span><span class="nx">points</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
	<span class="k">new</span> <span class="nx">SimplicialComplex</span><span class="p">(</span><span class="nx">points</span><span class="p">,</span><span class="nx">cells</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-97">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-97">&#182;</a>               </div>               <p><strong>TRIANGLEFAN</strong> multidimensional primitive with the first element of verts as pivot</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.TRIANGLEFAN = TRIANGLEFAN = </span><span class="nf">(points) -&gt;</span> 
	<span class="nv">edges = </span><span class="nx">POLYLINE</span> <span class="nx">points</span>
	<span class="nv">center = </span><span class="nx">CENTROID</span><span class="p">(</span><span class="nx">edges</span><span class="p">)([</span><span class="mi">0</span><span class="p">...</span><span class="nx">edges</span><span class="p">.</span><span class="nx">vertices</span><span class="p">.</span><span class="nx">m</span><span class="p">])</span>
	<span class="nv">points = </span><span class="nx">AR</span> <span class="p">[</span><span class="nx">edges</span><span class="p">.</span><span class="nx">vertices</span><span class="p">.</span><span class="nx">verts</span><span class="p">,[</span><span class="nx">center</span><span class="p">]]</span>
	<span class="nv">cells = </span><span class="p">(</span><span class="nx">AR</span> <span class="p">[</span><span class="nx">edge</span><span class="p">,</span> <span class="p">[</span><span class="nx">points</span><span class="p">.</span><span class="nx">length</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="nx">edge</span> <span class="k">in</span> <span class="nx">edges</span><span class="p">.</span><span class="nx">faces</span><span class="p">.</span><span class="nx">cells</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
	<span class="k">new</span> <span class="nx">SimplicialComplex</span><span class="p">(</span><span class="nx">points</span><span class="p">,</span><span class="nx">cells</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-98">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-98">&#182;</a>               </div>               <p><strong>TRIANGLEARRAY</strong> generator of a mesh of triangles from a matrix of d-dimesional points</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.TRIANGLEARRAY = TRIANGLEARRAY = </span><span class="nf">(m,n,points) -&gt;</span> 
	<span class="nv">out = </span><span class="nx">SIMPLEXGRID</span> <span class="p">[</span><span class="nx">REPEAT</span><span class="p">(</span><span class="nx">m</span><span class="p">)(</span><span class="mi">1</span><span class="p">),</span><span class="nx">REPEAT</span><span class="p">(</span><span class="nx">n</span><span class="p">)(</span><span class="mi">1</span><span class="p">)]</span>
	<span class="k">new</span> <span class="nx">SimplicialComplex</span><span class="p">(</span><span class="nx">CAT</span><span class="p">(</span><span class="nx">points</span><span class="p">),</span><span class="nx">out</span><span class="p">.</span><span class="nx">faces</span><span class="p">.</span><span class="nx">cells</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span></pre></div>             </td>           </tr>                               <tr id="section-99">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-99">&#182;</a>               </div>               <p><strong>INTERVALS</strong> constructor of a uniform partition of the 1D interval [0, tip] with n segments</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.INTERVALS = INTERVALS = </span><span class="nf">(tip) -&gt;</span> <span class="nf">(n) -&gt;</span> <span class="nx">SIMPLEXGRID</span> <span class="p">[</span><span class="nx">REPEAT</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="nx">tip</span><span class="err">/n]</span></pre></div>             </td>           </tr>                               <tr id="section-100">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-100">&#182;</a>               </div>               <p><strong>MAP</strong> simplicial mapping. It maps an array of coordinate funs over a simplicial complex pol. </p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.MAP = MAP = </span><span class="nf">(funs) -&gt;</span> <span class="nf">(pol) -&gt;</span>
	<span class="nv">points = </span><span class="p">(</span><span class="nx">CONS</span><span class="p">(</span><span class="nx">funs</span><span class="p">)</span> <span class="nx">v</span> <span class="k">for</span> <span class="nx">v</span> <span class="k">in</span> <span class="nx">pol</span><span class="p">.</span><span class="nx">vertices</span><span class="p">.</span><span class="nx">verts</span><span class="p">)</span>
	<span class="nv">d_cells = </span><span class="nx">pol</span><span class="p">.</span><span class="nx">faces</span><span class="p">.</span><span class="nx">cells</span><span class="p">[</span><span class="nx">pol</span><span class="p">.</span><span class="nx">faces</span><span class="p">.</span><span class="nx">dim</span><span class="p">]</span>
	<span class="k">new</span> <span class="nx">SimplicialComplex</span><span class="p">(</span><span class="nx">points</span><span class="p">,</span> <span class="nx">d_cells</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-101">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-101">&#182;</a>               </div>               <p><strong>CIRCLE</strong> returns o linear approximation of the 2D circle of given radius with n segments</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.CIRCLE = CIRCLE = </span><span class="nf">(radius,n=32) -&gt;</span>
	<span class="nv">domain = </span><span class="nx">SIMPLEXGRID</span> <span class="p">[</span><span class="nx">REPEAT</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="mi">2</span><span class="o">*</span><span class="nx">PI</span><span class="err">/n]</span>
	<span class="nx">MAP</span><span class="p">([</span><span class="nx">sin</span><span class="p">,</span><span class="nx">cos</span><span class="p">])(</span><span class="nx">domain</span><span class="p">).</span><span class="nx">s</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="nx">radius</span><span class="p">,</span><span class="nx">radius</span><span class="p">])</span> </pre></div>             </td>           </tr>                               <tr id="section-102">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-102">&#182;</a>               </div>               <p><strong>DISK</strong> returns on approx. with triangles of the 2D circle of given radius</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.DISK = DISK = </span><span class="nf">(radius=1,n=32,m=1) -&gt;</span>
	<span class="nv">domain = </span><span class="nx">SIMPLEXGRID</span> <span class="p">[</span><span class="nx">REPEAT</span><span class="p">(</span><span class="nx">n</span><span class="p">)(</span><span class="mi">2</span><span class="o">*</span><span class="nx">PI</span><span class="sr">/n), REPEAT(m)(radius/m</span><span class="p">)]</span>
	<span class="nv">fx = </span><span class="nf">([u,v]) -&gt;</span> <span class="nx">v</span><span class="o">*</span><span class="nx">sin</span><span class="p">(</span><span class="nx">u</span><span class="p">)</span>
	<span class="nv">fy = </span><span class="nf">([u,v]) -&gt;</span> <span class="nx">v</span><span class="o">*</span><span class="nx">cos</span><span class="p">(</span><span class="nx">u</span><span class="p">)</span>
	<span class="nx">MAP</span><span class="p">(</span> <span class="p">[</span><span class="nx">fx</span><span class="p">,</span> <span class="nx">fy</span><span class="p">]</span> <span class="p">)(</span><span class="nx">domain</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-103">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-103">&#182;</a>               </div>               <p><strong>GRAPH</strong> returns a simplicial approximation of the map of funs over the domain</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.GRAPH = GRAPH = </span><span class="nf">(domain) -&gt;</span> <span class="nf">(funs) -&gt;</span> <span class="nx">MAP</span><span class="p">(</span><span class="nx">funs</span><span class="p">)(</span><span class="nx">domain</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-104">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-104">&#182;</a>               </div>               <p><strong>HELIX</strong> returns a type of smooth space curve, i.e. a curve in three-dimensional space.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.HELIX = HELIX = </span><span class="nf">(radius=1,pitch=1,n=24,turns=1) -&gt;</span> 
	<span class="nv">domain = </span><span class="nx">INTERVALS</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nx">PI</span><span class="o">*</span><span class="nx">turns</span><span class="p">)(</span><span class="nx">n</span><span class="o">*</span><span class="nx">turns</span><span class="p">)</span>
	<span class="nx">GRAPH</span><span class="p">(</span> <span class="nx">domain</span> <span class="p">)(</span> <span class="p">[</span><span class="nx">sin</span><span class="p">,</span> <span class="nx">cos</span><span class="p">,</span> <span class="nx">ID</span><span class="p">]</span> <span class="p">).</span><span class="nx">s</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="nx">radius</span><span class="p">,</span><span class="nx">radius</span><span class="p">,</span><span class="nx">pitch</span><span class="err">/(2*PI)])</span></pre></div>             </td>           </tr>                               <tr id="section-105">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-105">&#182;</a>               </div>               <p><strong>QUADMESH</strong> generator of a mesh of triangles from a matrix of d-dimesional points</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.QUADMESH = QUADMESH = </span><span class="nf">(pointMat) -&gt;</span> 
	<span class="nv">m = </span><span class="nx">pointMat</span><span class="p">.</span><span class="nx">length</span>
	<span class="nv">n = </span><span class="nx">pointMat</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">length</span>
	<span class="nv">pairSeq = </span><span class="nx">CART2</span> <span class="p">[[</span><span class="mi">0</span><span class="p">...</span><span class="nx">m</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">...</span><span class="nx">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
	<span class="nv">cells = </span><span class="p">[]</span>
	<span class="nv">address = </span><span class="nf">([i,j]) -&gt;</span> <span class="nx">n</span><span class="o">*</span><span class="nx">i</span> <span class="o">+</span> <span class="nx">j</span> 
	<span class="k">for</span> <span class="nx">pair</span> <span class="k">in</span> <span class="nx">pairSeq</span>
		<span class="p">[</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">]</span> <span class="o">=</span> <span class="nx">pair</span>
		<span class="nv">t1 = </span><span class="nx">AA</span><span class="p">(</span><span class="nx">address</span><span class="p">)</span> <span class="p">[[</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">],[</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nx">j</span><span class="p">],[</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nx">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span>
		<span class="nv">t2 = </span><span class="nx">AA</span><span class="p">(</span><span class="nx">address</span><span class="p">)</span> <span class="p">[[</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="p">],[</span><span class="nx">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nx">j</span><span class="o">+</span><span class="mi">1</span><span class="p">],[</span><span class="nx">i</span><span class="p">,</span><span class="nx">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span>
		<span class="nx">cells</span><span class="p">.</span><span class="nx">push</span> <span class="nx">t1</span><span class="p">,</span><span class="nx">t2</span>
	<span class="nv">verts = </span><span class="nx">CAT</span> <span class="nx">pointMat</span>
	<span class="k">new</span> <span class="nx">SimplicialComplex</span><span class="p">(</span><span class="nx">verts</span><span class="p">,</span><span class="nx">cells</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-106">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-106">&#182;</a>               </div>               <p>LINSPACE1D constructor of a uniform partition of the 1D interval [0, tip] with n segments</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.LINSPACE1D = LINSPACE1D = </span><span class="nf">(tip,n=1) -&gt;</span> <span class="nx">SIMPLEXGRID</span> <span class="p">[</span><span class="nx">REPEAT</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="nx">tip</span><span class="err">/n]</span></pre></div>             </td>           </tr>                               <tr id="section-107">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-107">&#182;</a>               </div>               <p>LINSPACE2D generates a QUADMESH of points, Cartesian product of 2 intervals of size a,b</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.LINSPACE2D = LINSPACE2D = </span><span class="nf">(a=1,b=1,n=1,m=1) -&gt;</span> 
	<span class="nv">pointMat = </span><span class="nx">AA</span><span class="p">(</span><span class="nx">DISTL</span><span class="p">)</span> <span class="nx">DISTR</span> <span class="nx">AA</span><span class="p">(</span><span class="nx">PROGRESSIVE_SUM</span><span class="p">)</span> <span class="p">[</span><span class="nx">REPEAT</span><span class="p">(</span><span class="nx">n</span><span class="p">)(</span><span class="nx">a</span><span class="sr">/n), REPEAT(m)(b/m</span><span class="p">)]</span>
	<span class="nx">QUADMESH</span><span class="p">(</span><span class="nx">pointMat</span><span class="p">)</span> </pre></div>             </td>           </tr>                               <tr id="section-108">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-108">&#182;</a>               </div>               <p>LINSPACE3D generates a simplex 3D-grid of points, Cartesian product of 3 intervals of size a,b,c.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.LINSPACE3D = LINSPACE3D = </span><span class="nf">(a=1,b=1,c=1,n=1,m=1,p=1) -&gt;</span>
	<span class="nv">domain2d = </span><span class="nx">LINSPACE2D</span> <span class="p">[</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">n</span><span class="p">,</span> <span class="nx">m</span><span class="p">]</span>
	<span class="nv">hLists = </span><span class="nx">PROGRESSIVE_SUM</span> <span class="nx">REPEAT</span><span class="p">(</span><span class="nx">p</span><span class="p">)(</span><span class="nx">c</span><span class="err">/p)</span>
	<span class="nx">EXTRUDE</span><span class="p">(</span><span class="nx">hLists</span><span class="p">)</span> <span class="nx">domain2d</span></pre></div>             </td>           </tr>                               <tr id="section-109">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-109">&#182;</a>               </div>               <p><strong>CYLSURFACE</strong> produces a cylindrical surface of radius r and heigth h</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.CYLSURFACE = CYLSURFACE = </span><span class="nf">(r=1, h=1, n=16, m=2) -&gt;</span> 
	<span class="nv">domain = </span><span class="nx">LINSPACE2D</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="nx">PI</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="nx">n</span><span class="p">,</span> <span class="nx">m</span><span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-110">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-110">&#182;</a>               </div>               <p>domain = SIMPLEXGRID [REPEAT(n)(2*PI/n), REPEAT(m)(1.0/m)]</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">fx = </span><span class="nf">([u,v]) -&gt;</span> <span class="nx">r</span><span class="o">*</span><span class="nx">cos</span><span class="p">(</span><span class="nx">u</span><span class="p">)</span>
	<span class="nv">fy = </span><span class="nf">([u,v]) -&gt;</span> <span class="nx">r</span><span class="o">*</span><span class="nx">sin</span><span class="p">(</span><span class="nx">u</span><span class="p">)</span>
	<span class="nv">fz = </span><span class="nf">([u,v]) -&gt;</span> <span class="nx">h</span><span class="o">*</span><span class="nx">v</span>
	<span class="nx">MAP</span><span class="p">(</span> <span class="p">[</span><span class="nx">fx</span><span class="p">,</span> <span class="nx">fy</span><span class="p">,</span> <span class="nx">fz</span><span class="p">]</span> <span class="p">)(</span> <span class="nx">domain</span> <span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-111">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-111">&#182;</a>               </div>               <p><strong>CYLSOLID</strong> produces a solid cylinder possibly with a cylindrical hole of radius r</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.CYLSOLID = CYLSOLID = </span><span class="nf">(R=1, r=0, h=1, n=16, m=1, p=1) -&gt;</span> 
	<span class="nv">domain = </span><span class="nx">LINSPACE3D</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="nx">PI</span><span class="p">,</span> <span class="nx">R</span><span class="o">-</span><span class="nx">r</span><span class="p">,</span> <span class="nx">h</span><span class="p">,</span> <span class="nx">n</span><span class="p">,</span> <span class="nx">m</span><span class="p">,</span> <span class="nx">p</span><span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-112">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-112">&#182;</a>               </div>               <p>domain = SIMPLEXGRID [REPEAT(n)(2*PI/n), REPEAT(m)((R-r)/m), REPEAT(p)(h/p)]</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">fx = </span><span class="nf">([u,v,w]) -&gt;</span> <span class="nx">v</span><span class="o">*</span><span class="nx">cos</span><span class="p">(</span><span class="nx">u</span><span class="p">)</span>
	<span class="nv">fy = </span><span class="nf">([u,v,w]) -&gt;</span> <span class="o">-</span><span class="nx">v</span><span class="o">*</span><span class="nx">sin</span><span class="p">(</span><span class="nx">u</span><span class="p">)</span>
	<span class="nv">fz = </span><span class="nf">([u,v,w]) -&gt;</span> <span class="nx">w</span>
	<span class="nx">MAP</span><span class="p">(</span> <span class="p">[</span><span class="nx">fx</span><span class="p">,</span> <span class="nx">fy</span><span class="p">,</span> <span class="nx">fz</span><span class="p">]</span> <span class="p">)(</span> <span class="nx">domain</span><span class="p">.</span><span class="nx">t</span><span class="p">([</span><span class="mi">1</span><span class="p">],[</span><span class="nx">r</span><span class="p">])</span> <span class="p">)</span>
	</pre></div>             </td>           </tr>                               <tr id="section-113">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-113">&#182;</a>               </div>               <p><strong>TORUSSURFACE</strong> produces a toroidal surface of radiuses r,R approximated with n x m x 2 triangles</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.TORUSSURFACE = TORUSSURFACE = </span><span class="nf">(r=1, R=3, n=12, m=8) -&gt;</span> 
	<span class="nv">domain = </span><span class="nx">LINSPACE2D</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="nx">PI</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="nx">PI</span><span class="p">,</span> <span class="nx">n</span><span class="p">,</span> <span class="nx">m</span><span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-114">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-114">&#182;</a>               </div>               <p>domain = SIMPLEXGRID [ REPEAT(n)(2<em>PI/n), REPEAT(m)(2</em>PI/m) ]</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">fx = </span><span class="nf">([u,v]) -&gt;</span> <span class="p">(</span><span class="nx">R</span> <span class="o">+</span> <span class="nx">r</span> <span class="o">*</span> <span class="nx">cos</span><span class="p">(</span><span class="nx">v</span><span class="p">))</span> <span class="o">*</span> <span class="nx">cos</span><span class="p">(</span><span class="nx">u</span><span class="p">)</span>
	<span class="nv">fy = </span><span class="nf">([u,v]) -&gt;</span> <span class="p">(</span><span class="nx">R</span> <span class="o">+</span> <span class="nx">r</span> <span class="o">*</span> <span class="nx">cos</span><span class="p">(</span><span class="nx">v</span><span class="p">))</span> <span class="o">*</span> <span class="nx">sin</span><span class="p">(</span><span class="nx">u</span><span class="p">)</span>
	<span class="nv">fz = </span><span class="nf">([u,v]) -&gt;</span> <span class="nx">r</span> <span class="o">*</span> <span class="nx">sin</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span>
	<span class="nx">MAP</span><span class="p">(</span> <span class="p">[</span><span class="nx">fx</span><span class="p">,</span> <span class="nx">fy</span><span class="p">,</span> <span class="nx">fz</span><span class="p">]</span> <span class="p">)(</span> <span class="nx">domain</span> <span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-115">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-115">&#182;</a>               </div>               <pre><code>TORUSSOLID produces a solid torus of radiuses r,R approximated with tetrahedra
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.TORUSSOLID = TORUSSOLID = </span><span class="nf">(r=1,R=3,n=8,m=16,p=1) -&gt;</span> 
	<span class="nv">domain = </span><span class="nx">LINSPACE3D</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="nx">PI</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="nx">PI</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">n</span><span class="p">,</span> <span class="nx">m</span><span class="p">,</span> <span class="nx">p</span><span class="p">]</span></pre></div>             </td>           </tr>                               <tr id="section-116">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-116">&#182;</a>               </div>               <p>domain = SIMPLEXGRID [REPEAT(n)(2<em>PI/n), REPEAT(m)(2</em>PI/m), REPEAT(p)(1/p)]</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">fx = </span><span class="nf">([u,v,w]) -&gt;</span> <span class="p">(</span><span class="nx">R</span> <span class="o">+</span> <span class="nx">r</span> <span class="o">*</span> <span class="nx">w</span> <span class="o">*</span> <span class="nx">cos</span><span class="p">(</span><span class="nx">u</span><span class="p">))</span> <span class="o">*</span> <span class="nx">cos</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span>
	<span class="nv">fy = </span><span class="nf">([u,v,w]) -&gt;</span> <span class="p">(</span><span class="nx">R</span> <span class="o">+</span> <span class="nx">r</span> <span class="o">*</span> <span class="nx">w</span> <span class="o">*</span> <span class="nx">cos</span><span class="p">(</span><span class="nx">u</span><span class="p">))</span> <span class="o">*</span> <span class="o">-</span><span class="nx">sin</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span>
	<span class="nv">fz = </span><span class="nf">([u,v,w]) -&gt;</span> <span class="nx">r</span> <span class="o">*</span> <span class="nx">w</span> <span class="o">*</span> <span class="nx">sin</span><span class="p">(</span><span class="nx">u</span><span class="p">)</span>
	<span class="nx">MAP</span><span class="p">(</span> <span class="p">[</span><span class="nx">fx</span><span class="p">,</span> <span class="nx">fy</span><span class="p">,</span> <span class="nx">fz</span><span class="p">]</span> <span class="p">)(</span> <span class="nx">domain</span> <span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-117">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-117">&#182;</a>               </div>               <p>#</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.SCHLEGEL = SCHLEGEL = </span><span class="nf">(pol) -&gt;</span> <span class="nf">(point) -&gt;</span> 



<span class="nx">def</span> <span class="nx">SCHLEGEL</span><span class="p">(</span><span class="nx">pol</span><span class="p">)</span><span class="o">:</span>
	<span class="nx">def</span> <span class="nx">project</span><span class="p">(</span><span class="nx">point</span><span class="p">)</span><span class="o">:</span>
		<span class="k">return</span> <span class="p">[</span><span class="nx">coord</span><span class="err">/point[-1] for coord in point[:-1]]</span>
	<span class="nv">verts = </span><span class="p">[</span><span class="nx">project</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="k">for</span> <span class="nx">v</span> <span class="k">in</span> <span class="nx">pol</span><span class="p">.</span><span class="nx">vertices</span><span class="p">.</span><span class="nx">points</span><span class="p">]</span>
	<span class="nv">cells = </span><span class="nx">pol</span><span class="p">.</span><span class="nx">cells</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
	<span class="k">return</span> <span class="nx">PolytopalComplex</span><span class="p">(</span><span class="nx">verts</span><span class="p">,</span><span class="nx">cells</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-118">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-118">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="nv">root.POLYGON = POLYGON = </span><span class="nf">(n) -&gt;</span> 
	<span class="nv">points = </span><span class="p">[[</span><span class="nx">cos</span><span class="p">(</span><span class="nx">alpha</span><span class="p">),</span><span class="nx">sin</span><span class="p">(</span><span class="nx">alpha</span><span class="p">)]</span>
			  <span class="k">for</span> <span class="nx">alpha</span> <span class="k">in</span> <span class="p">(</span><span class="nx">scipy</span><span class="p">.</span><span class="nx">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="nx">pi</span><span class="p">,</span> <span class="nx">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nx">pi</span><span class="o">*</span><span class="nx">n</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>
	<span class="k">return</span> <span class="nx">TRIANGLEFAN</span><span class="p">(</span><span class="nx">points</span><span class="p">)</span>	

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 